{% extends 'base.html' %}

{% load humanize %}
{% load i18n %}

{% block title %}Blog{% endblock title %}

{% block pageheader %}
<div class="page-header header-filter header-small" {% if blogcover %}style="background-image: url('{{ blogcover.image }}'); transform: translate3d(0px, 0px, 0px);"{% endif %}>
    <div class="container">
        <div class="row">
            <div class="col-md-8 ml-auto mr-auto text-center">
                <h2 class="title">Diventi Blog</h2>
                <h4>{% trans "Our Latest Stories" %}.</h4>
            </div>
        </div>
    </div>
</div>
{% endblock pageheader %}

{% block content %}
<div class="section">
    <div class="container">
        <div class="row">
            <div class="col-md-10 ml-auto mr-auto">
                <br>
                    {% for article in articles %}                    
                        <div class="card card-plain card-blog">
                            <div class="row">
                                <div class="col-md-4">
                                    <div class="card-header card-header-image">
                                        {% if article.image %}
                                            <img class="img img-raised" src="{{ article.image }}">
                                        {% endif %}
                                    </div>
                                </div>
                                <div class="col-md-8">                                            
                                    <h6 class="card-category text-info">
                                        {{ article.category }}
                                        {% if article.hot %} 
                                            <span class="fa-layers fa-2x fa-fw text-danger">
                                                <i class="fas fa-certificate"></i>
                                                <span class="fa-layers-text fa-inverse" data-fa-transform="shrink-11.5 rotate--30" style="font-weight:900">{% trans 'Hot' %}</span>
                                            </span>
                                        {% endif %}
                                    </h6>
                                    <h3 class="card-title">
                                        <a href="{% url 'blog:detail' article.slug %}">{{ article.title|capfirst }}</a>
                                    </h3>
                                    <p class="card-description">
                                        {{ article.description|striptags }}                                        
                                    </p>
                                    <p class="author">
                                        {% load comment_extras %}
                                        {% load comments %}
                                        {% get_comment_count for article as comment_count %}
                                        <span class="text-gray">
                                        by <a href="{{ article.author.get_absolute_url }}"><strong>{{ article.author.get_full_name }}</strong></a>
                                        &middot; 
                                        {{ article.publication_date|naturalday }}
                                        &middot;
                                        <i class="fal fa-comments"></i> {{ comment_count }}
                                        &middot;
                                        <i class="fal fa-thumbs-up"></i> {{ article.promotions.count }}
                                        </span>
                                    </p>                            
                                </div>
                            </div>
                        </div>                        
                        {% empty %}
                        <div class="text-center">
                            <h3>{% trans "There are no posts yet" %} <i class="fal fa-frown"></i></h3>
                        </div>
                    {% endfor %}
            </div> <!-- End grid column -->
        </div> <!-- End row -->
        {% if is_paginated %}
            <br>
            <div class="row">
                <div class="col-md-12">
                    <ul class="pagination pagination-warning" style="justify-content: center;">
                    {% if page_obj.has_previous %}
                      <li class="page-item"><a class="page-link" href="?page={{ page_obj.previous_page_number }}">{% trans "Previous" %}</a></li>
                    {% else %}
                      <li class="page-item disabled"><span class="page-link">{% trans "Previous" %}</span></li>
                    {% endif %}
                    {% for i in page_obj.paginator.page_range %}
                      {% if page_obj.number == i %}
                        <li class="page-item active"><span class="page-link">{{ i }} <span class="sr-only">({% trans "current" %})</span></span></li>
                      {% else %}
                        <li class="page-item"><a class="page-link" href="?page={{ i }}">{{ i }}</a></li>
                      {% endif %}
                    {% endfor %}
                    {% if page_obj.has_next %}
                      <li class="page-item"><a class="page-link" href="?page={{ page_obj.next_page_number }}">{% trans "Next" %}</a></li>
                    {% else %}
                      <li class="page-item disabled"><span class="page-link">{% trans "Next" %}</span></li>
                    {% endif %}
                    </ul>
                </div>
            </div>
        {% endif %}
    </div> <!-- End container -->
</div> <!-- End section -->
{% endblock content %}